#include <d2V_spring_particle_particle_dq2.h>

void d2V_spring_particle_particle_dq2(Eigen::Ref<Eigen::Matrix66d> H, Eigen::Ref<const Eigen::Vector3d> q0,  Eigen::Ref<const Eigen::Vector3d> q1, double l0, double stiffness) {
//Input:
//  q0 - the generalized coordinates of the first node of the spring
//  q1 - the generalized coordinates of the second node of the spring
//  l0 - the undeformed length of the spring
//  stiffness - the stiffness constant for this spring
//Output:
//  H - the 6x6 dense per spring hessian of the energy function

    // q0(0) = x1, q0(1) = x2, q0(2) = x3, q1(0) = x4, q1(1) = x5, q1(2) = x6
    double x1 = q0(0), x2 = q0(1), x3 = q0(2), x4 = q1(0), x5 = q1(1), x6 = q1(2), k = stiffness;
       
    H(0, 0) = (k*pow(x1*2.0-x4*2.0,2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)-k*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))*2.0+(k*pow(x1*2.0-x4*2.0,2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(0, 1) = (k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)+(k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(0, 2) = (k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)+(k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(0, 3) = (k*pow(x1*2.0-x4*2.0,2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))+k*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))*2.0-(k*pow(x1*2.0-x4*2.0,2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(0, 4) = (k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))-(k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(0, 5) = (k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))-(k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(1, 0) = (k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)+(k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(1, 1) = (k*pow(x2*2.0-x5*2.0,2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)-k*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))*2.0+(k*pow(x2*2.0-x5*2.0,2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(1, 2) = (k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)+(k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(1, 3) = (k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))-(k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(1, 4) = (k*pow(x2*2.0-x5*2.0,2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))+k*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))*2.0-(k*pow(x2*2.0-x5*2.0,2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(1, 5) = (k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))-(k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(2, 0) = (k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)+(k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(2, 1) = (k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)+(k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(2, 2) = (k*pow(x3*2.0-x6*2.0,2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)-k*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))*2.0+(k*pow(x3*2.0-x6*2.0,2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(2, 3) = (k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))-(k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(2, 4) = (k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))-(k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(2, 5) = (k*pow(x3*2.0-x6*2.0,2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))+k*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))*2.0-(k*pow(x3*2.0-x6*2.0,2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(3, 0) = (k*pow(x1*2.0-x4*2.0,2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))+k*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))*2.0-(k*pow(x1*2.0-x4*2.0,2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(3, 1) = (k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))-(k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(3, 2) = (k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))-(k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(3, 3) = (k*pow(x1*2.0-x4*2.0,2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)-k*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))*2.0+(k*pow(x1*2.0-x4*2.0,2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(3, 4) = (k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)+(k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(3, 5) = (k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)+(k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(4, 0) = (k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))-(k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(4, 1) = (k*pow(x2*2.0-x5*2.0,2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))+k*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))*2.0-(k*pow(x2*2.0-x5*2.0,2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(4, 2) = (k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))-(k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(4, 3) = (k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)+(k*(x1*2.0-x4*2.0)*(x2*2.0-x5*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(4, 4) = (k*pow(x2*2.0-x5*2.0,2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)-k*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))*2.0+(k*pow(x2*2.0-x5*2.0,2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(4, 5) = (k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)+(k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(5, 0) = (k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))-(k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(5, 1) = (k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))-(k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(5, 2) = (k*pow(x3*2.0-x6*2.0,2.0)*(-1.0/2.0))/(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))+k*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))*2.0-(k*pow(x3*2.0-x6*2.0,2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(5, 3) = (k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)+(k*(x1*2.0-x4*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(5, 4) = (k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)+(k*(x2*2.0-x5*2.0)*(x3*2.0-x6*2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
    H(5, 5) = (k*pow(x3*2.0-x6*2.0,2.0))/(pow(x1-x4,2.0)*2.0+pow(x2-x5,2.0)*2.0+pow(x3-x6,2.0)*2.0)-k*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0))*2.0+(k*pow(x3*2.0-x6*2.0,2.0)*(l0-sqrt(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0)))*1.0/pow(pow(x1-x4,2.0)+pow(x2-x5,2.0)+pow(x3-x6,2.0),3.0/2.0))/2.0;
}
